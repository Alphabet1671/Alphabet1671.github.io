---
layout: post
title:  "Aero Rake"
date:   2025-04-02 00:00:00 -0500
categories: Technical
tags: Aero Thermal
---
## Introduction
Long story short, when I was testing the radiator-fan combo to model the heat dissipation and nail down the lightest combo that would dissipate enough heat, I realized how stupid a single flow rate measurement at the center was. It was a 20mm $\times$ 250mm radiator with two fans stacked vertically. The solid part of the fan alone probably accounted for more than 20% of the radiator area, so measuring at the center is nowhere close to where it would be. So the next step forward was simple, simply measure flow rate at many different points and average them out. There's been conversation on the team about making an aero rake before, but it's been shot down due to its precieved complexity. I decided to just call caps on that and give it a go.
## Component Selection
Let's talk about the exciting part of this: the constraints:

I'm doing this as a side project. The fact that I still have vertical dynamics and thermals to worry about on the car means that spending more than a week on this would be literally a crime. The original reason to reject this project was that it costs too much, so I'll also try to keep it below \$1000 so that our treasurer doesn't get mad about me. In order for this to work, I would need to buy some pitot tubes as they're the only thing small enough to measure a velocity field for my radiators. I'd also need something to convert that differential air pressure into CAN messages that the car would understand. Of course, all of that needs to be simple and cheap, what are my options? 
Modern R/C aircraft flight controls are honeslty surprisingly advanced, with some quadcopters featuring real-time feedback control. Some of these control algortithms, as it turns out, take in airspeed as an input. The result of that is that I can buy a pitot tube and differential pressure sensor pair for only \$50 on Amazon. That's great, but unfortunately most R/C aircrafts don't need 8 of them like I do, so the pressure cell speaks I2C with a fixed address, meaning that I would need to do something crazy to get 8 of them to speak CAN at the same time as I can't multiplex them natively because they have different addresses. I eventually discovered the [Adafruit Multiplexer](https://www.adafruit.com/product/2717) that allows me to switch between 8 of the same I2C devices with the same address. From there, I simply need to pick an MCU that speaks both I2C and CAN, and I picked [CAN485](https://www.sparkfun.com/sparkfun-ast-can485-dev-board.html) because it's already used as the old combustion car's steering wheel board. 

## Pressure Sensor Calibration
They're digital sensors, so I have a little more trust in them, but nonetheless I still would like to make sure the pressure reading of them are realistic. So I constructed this contraption:
![pressure sensor setup](/images/posts/2025-04-02-Aero-Rake/image-2025-3-27_1-15-59.png)
Yes, I am fully aware how funny it looks, but it serves the purpose of comparing the pressure sensor reading with a known good digital manometer just fine. All I do is use the bike pump to get to some pressure, log the sensor and read off the manometer to make the curve:
![sensor reading](/images/posts/2025-04-02-Aero-Rake/image-2025-3-27_1-23-30.png)
![calibration curve](/images/posts/2025-04-02-Aero-Rake/image-2025-3-27_1-40-38.png)

The $R^2$ value looks superb.
## Sensor Reading
Putting all the sensors together, I was able to get them to read with a little bit of code (it's on team internal git sadly). Here's the result:

![sensor reading](/images/posts/2025-04-02-Aero-Rake/image-2025-3-28_22-2-16.png)

Looks a little noisy, so I also added a feature where it zeros itself averaging over the first ten seconds within recieving power. 

## Final Product
Putting the whole thing together with some soldering job later:

![aero sensor baord](/images/posts/2025-04-02-Aero-Rake/rn_image_picker_lib_temp_9177d78c-0e2b-468a-aa7d-74b971f2dcc7.jpg)
![aero sensor board](/images/posts/2025-04-02-Aero-Rake/rn_image_picker_lib_temp_b0d2f087-934c-415d-9b1e-ec32c3a85feb.jpg)

On our team we always mock the aero subsystem for having poor build quality, so I, ofcourse, decided to carry on that legacy by using a piece of scrap wood that I found randomly lying around shop for the chassis.

I then connected with a 3D printed rack of pitot tubes:

![rake in radiator](/images/posts/2025-04-02-Aero-Rake/image-2025-4-4_14-49-7.png)
## Readings
I took the radiator with pitot tubes in it to the wind tunnel and was able to get some really useful flow rate data out of it, despite it being incredibly noisy:

![matlab plot](/images/posts/2025-04-02-Aero-Rake/image-2025-4-4_15-37-15.png)

It shows that I've significantly underestimated the fan's dragging effects when the ram air flow rate exceeds the fan's maximum flow rate (yikes).
## Results
In addition to reading radiator data, it can also be used to read pressure taps (just leave the other side of the pressure sensor open), and measure velocity all over the car as a powerful CFD correlation tool. 